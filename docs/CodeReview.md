# 智能家教推荐系统代码审查与功能实现文档

## 1. 系统架构

系统采用前后端分离架构，后端使用 Node.js + Express + MongoDB 技术栈，前端分为家长端、教师端和管理员端三个独立的应用。

### 1.1 目录结构

```
SmartTurtor_Server/
  ├── app/
  │   ├── controllers/    # 控制器
  │   ├── middlewares/    # 中间件
  │   ├── routes/         # 路由
  │   ├── services/       # 业务逻辑
  │   └── utils/          # 工具函数
  ├── config/            # 配置文件
  ├── models/            # 数据模型
  └── logs/              # 日志文件
```

## 2. 数据模型设计

### 2.1 用户模型 (User)

- 支持多角色：家长、教师、管理员
- 自定义 ID 生成规则：TUTOR*/PARENT*/ADMIN\_ + 14 位时间戳
- 包含基本信息：用户名、密码、头像等
- 状态管理：活跃、非活跃、封禁

### 2.2 家长模型 (Parent)

- 基本信息：昵称、位置信息
- 子女信息管理：支持多个子女
- 教学偏好设置：教学地点、教师性别偏好、预算等
- 统计信息：发帖数、合作教师数等

### 2.3 教师模型 (TutorProfile)

- 个人信息：姓名、性别、学历背景
- 教学经验：教龄、教授科目、成功案例
- 排课管理：周末可用时间段设置
- 位置信息：支持地理位置查询
- 评分系统：多维度评分（教学质量、态度等）

### 2.4 求教帖子模型 (TutoringRequest)

- 关联家长和子女信息
- 年级和科目需求
- 位置信息：支持地理位置查询
- 教学偏好：教学地点、预算等
- 状态管理：开放、关闭、归档

## 3. 已实现功能

### 3.1 用户管理

- [x] 用户注册与登录
- [x] 角色验证
- [x] 用户状态管理

### 3.2 家长功能

- [x] 子女信息管理（CRUD）
- [x] 发布求教帖子
- [x] 设置教学偏好
- [x] 地理位置管理

### 3.3 教师功能

- [x] 资料卡管理
- [x] 教授科目管理
- [x] 排课时间设置
- [x] 位置信息更新

### 3.4 求教帖子管理

- [x] 发布帖子
- [x] 帖子状态管理
- [x] 地理位置查询
- [x] 按条件筛选（年级、科目等）

## 4. 特色功能

### 4.1 地理位置服务

- 支持经纬度坐标存储
- 实现附近教师查询
- 支持按区域筛选

### 4.2 智能匹配

- 基于地理位置的匹配
- 考虑教学偏好匹配
- 科目和年级匹配

### 4.3 排课管理

- 灵活的时间段设置
- 支持周末不同时段管理
- 课程时长可配置

## 5. 待优化项

1. 教师评分系统的完善
2. 智能匹配算法的优化
3. 实时通知系统的实现
4. 支付系统的集成

## 6. 安全性考虑

- 密码加密存储
- 用户认证和授权
- 输入验证和清理
- 日志记录和监控

## 7. 性能优化

- MongoDB 索引优化
- 地理位置查询优化
- 数据模型设计优化

## 8. 代码质量

- 遵循 ESLint 规范
- 使用 TypeScript 类型检查
- 完善的错误处理
- 详细的日志记录
